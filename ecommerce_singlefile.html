<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple E‑commerce</title>
  <style>
    /* Simple reset and layout */
    :root{--primary:#0b71f4;--muted:#666}
    *{box-sizing:border-box}body{font-family:Inter,system-ui,Arial;margin:0;color:#111}
    header{background:#fff;border-bottom:1px solid #eee;padding:12px 18px;display:flex;align-items:center;gap:14px}
    .brand{font-weight:700;color:var(--primary)}
    nav a{margin-right:10px;text-decoration:none;color:var(--muted)}
    .container{padding:18px;max-width:1100px;margin:0 auto}

    /* grid for home */
    .layout{display:grid;grid-template-columns:260px 1fr;gap:18px}
    .filters{background:#fff;padding:12px;border:1px solid #eee;border-radius:8px}
    .products{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}
    .card{border:1px solid #eee;padding:12px;border-radius:8px;background:#fff;display:flex;flex-direction:column}
    .card img{width:100%;height:150px;object-fit:cover;border-radius:6px}
    .card h4{margin:8px 0 4px;font-size:15px}
    .card .price{font-weight:700}
    button{background:var(--primary);color:#fff;border:0;padding:8px 10px;border-radius:6px;cursor:pointer}
    button.secondary{background:#eee;color:#111}
    .muted{color:var(--muted);font-size:13px}

    /* pages */
    .page{display:none}
    .page.active{display:block}

    /* small components */
    .row{display:flex;gap:8px;align-items:center}
    .spacer{flex:1}
    input[type=text], input[type=email], input[type=password], select{padding:8px;border:1px solid #ddd;border-radius:6px;width:100%}
    .list{list-style:none;padding:0;margin:0}
    .list li{padding:8px 0;border-bottom:1px dashed #f0f0f0}
    footer{padding:18px;text-align:center;color:var(--muted)}

    /* responsive */
    @media(max-width:800px){.layout{grid-template-columns:1fr}.filters{order:2}}
  </style>
</head>
<body>
  <header>
    <div class="brand" onclick="navigate('home')" style="cursor:pointer">DarshanEnterprises</div>
    <nav id="mainNav"></nav>
    <div class="spacer"></div>
    <div id="authButtons"></div>
  </header>

  <div class="container">
    <!-- HOME -->
    <div id="home" class="page active">
      <div class="layout">
        <aside class="filters">
          <h3>Filters</h3>
          <label>Search
            <input type="text" id="searchInput" placeholder="search products...">
          </label>
          <label style="display:block;margin-top:8px">Category
            <select id="categorySelect">
              <option value="all">All</option>
            </select>
          </label>
          <label style="display:block;margin-top:8px">Price range
            <select id="priceSelect"><option value="all">All</option><option value="0-50">0 - 50</option><option value="50-150">50 - 150</option><option value="150-1000">150+</option></select>
          </label>
          <label style="display:block;margin-top:8px">Sort
            <select id="sortSelect"><option value="default">Default</option><option value="price-asc">Price ↑</option><option value="price-desc">Price ↓</option></select>
          </label>
          <div style="margin-top:10px"><button onclick="applyFilters()">Apply</button> <button class="secondary" onclick="resetFilters()">Reset</button></div>
        </aside>

        <main>
          <div class="row" style="margin-bottom:12px">
            <h2>Products</h2>
            <div class="spacer"></div>
            <div class="muted">Showing <span id="countProducts">0</span> items</div>
          </div>

          <div id="products" class="products"></div>
        </main>
      </div>
    </div>

    <!-- CART -->
    <div id="cart" class="page">
      <h2>Cart</h2>
      <div id="cartList"></div>
      <div style="margin-top:12px" class="row"><div class="spacer"></div><div id="cartSummary"></div></div>
      <div style="margin-top:12px"><button onclick="checkout()">Checkout</button></div>
    </div>

    <!-- WISHLIST -->
    <div id="wishlist" class="page">
      <h2>Wishlist</h2>
      <div id="wishListContainer"></div>
    </div>

    <!-- PROFILE (orders) -->
    <div id="profile" class="page">
      <h2>Profile & Orders</h2>
      <div id="profileInfo"></div>
      <h3 style="margin-top:12px">Orders</h3>
      <ul id="ordersList" class="list"></ul>
    </div>

    <!-- LOGIN -->
    <div id="login" class="page">
      <h2>Login</h2>
      <div style="max-width:420px">
        <label>Email<input type="email" id="loginEmail"></label>
        <label>Password<input type="password" id="loginPass"></label>
        <div style="margin-top:8px"><button onclick="doLogin()">Login</button> <button class="secondary" onclick="navigate('register')">Register</button></div>
        <div id="loginMsg" class="muted" style="margin-top:6px"></div>
      </div>
    </div>

    <!-- REGISTER -->
    <div id="register" class="page">
      <h2>Register</h2>
      <div style="max-width:420px">
        <label>Name<input type="text" id="regName"></label>
        <label>Email<input type="email" id="regEmail"></label>
        <label>Password<input type="password" id="regPass"></label>
        <div style="margin-top:8px"><button onclick="doRegister()">Create account</button> <button class="secondary" onclick="navigate('login')">Back to login</button></div>
        <div id="regMsg" class="muted" style="margin-top:6px"></div>
      </div>
    </div>

  </div>

  <footer>Simple demo e‑commerce — data kept in localStorage</footer>

  <script>
    /*********************
     * Simple demo data and utils
     *********************/
    const sampleProducts = [
      {id:1,title:'Classic White T-shirt',price:29,category:'Clothing',img: 'tshirt.jpg'},
      {id:2,title:'Blue Jeans',price:79,category:'Clothing',img:'https://picsum.photos/seed/p2/400/300'},
      {id:3,title:'Sneakers',price:129,category:'Footwear',img:'https://picsum.photos/seed/p3/400/300'},
      {id:4,title:'Leather Wallet',price:49,category:'Accessories',img:'https://picsum.photos/seed/p4/400/300'},
      {id:5,title:'Smart Watch',price:199,category:'Electronics',img:'https://picsum.photos/seed/p5/400/300'},
      {id:6,title:'Sunglasses',price:99,category:'Accessories',img:''},
      {id:7,title:'Backpack',price:59,category:'Bags',img:'https://picsum.photos/seed/p7/400/300'},
      {id:8,title:'Headphones',price:149,category:'Electronics',img:'https://picsum.photos/seed//400/300'}
    ];

    // --- localStorage helpers ---
    function getUsers(){return JSON.parse(localStorage.getItem('users')||'[]')}
    function saveUsers(u){localStorage.setItem('users',JSON.stringify(u))}
    function currentUser(){return JSON.parse(localStorage.getItem('currentUser')||'null')}
    function setCurrentUser(u){localStorage.setItem('currentUser',JSON.stringify(u))}

    function cartKey(email){return 'cart_'+email}
    function wishKey(email){return 'wish_'+email}
    function ordersKey(email){return 'orders_'+email}

    /*********************
     * Routing and UI
     *********************/
    function navigate(page){
      document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
      const el = document.getElementById(page);
      if(el) el.classList.add('active');
      window.location.hash = page;
      renderNav();
      if(page==='home') renderProducts();
      if(page==='cart') renderCart();
      if(page==='wishlist') renderWishlist();
      if(page==='profile') renderProfile();
    }

    window.addEventListener('hashchange',()=>{const h=location.hash.replace('#',''); if(h) navigate(h)})

    function renderNav(){
      const nav = document.getElementById('mainNav'); nav.innerHTML='';
      const pages = ['home','cart','wishlist','profile'];
      pages.forEach(p=>{
        const a = document.createElement('a'); a.href='#'+p; a.textContent=p.charAt(0).toUpperCase()+p.slice(1);
        nav.appendChild(a);
      });
      const auth = document.getElementById('authButtons'); auth.innerHTML='';
      const user = currentUser();
      if(user){
        const name = document.createElement('span'); name.textContent = user.name + ' • ' + user.email; name.className='muted'; auth.appendChild(name);
        const logout = document.createElement('button'); logout.textContent='Logout'; logout.style.marginLeft='8px'; logout.onclick=doLogout; auth.appendChild(logout);
      } else {
        const login = document.createElement('button'); login.textContent='Login'; login.onclick=()=>navigate('login'); auth.appendChild(login);
        const reg = document.createElement('button'); reg.textContent='Register'; reg.style.marginLeft='8px'; reg.onclick=()=>navigate('register'); auth.appendChild(reg);
      }
    }

    /*********************
     * Products rendering and filters
     *********************/
    let products = JSON.parse(localStorage.getItem('products')||'null') || sampleProducts;
    localStorage.setItem('products', JSON.stringify(products));

    function populateCategory(){
      const sel = document.getElementById('categorySelect'); sel.innerHTML='<option value="all">All</option>';
      [...new Set(products.map(p=>p.category))].forEach(c=>{const opt=document.createElement('option');opt.value=c;opt.textContent=c;sel.appendChild(opt)})
    }

    function renderProducts(list){
      list = list || products;
      const out = document.getElementById('products'); out.innerHTML='';
      document.getElementById('countProducts').textContent = list.length;
      list.forEach(p=>{
        const c = document.createElement('div'); c.className='card';
        c.innerHTML = `\n          <img src="${p.img}" alt="${p.title}">\n          <h4>${p.title}</h4>\n          <div class="muted">${p.category}</div>\n          <div class="row" style="margin-top:auto">\n            <div>\n              <div class=\"price\">$${p.price}</div>\n            </div>\n            <div class="spacer"></div>\n            <div>\n              <button onclick=\"addToCart(${p.id})\">Add</button>\n              <button class=\"secondary\" onclick=\"toggleWish(${p.id})\">♡</button>\n            </div>\n          </div>`;
        out.appendChild(c);
      })
    }

    function applyFilters(){
      const search = document.getElementById('searchInput').value.trim().toLowerCase();
      const cat = document.getElementById('categorySelect').value;
      const price = document.getElementById('priceSelect').value;
      const sort = document.getElementById('sortSelect').value;

      let list = products.filter(p=> (cat==='all'||p.category===cat) && (search===''||p.title.toLowerCase().includes(search)) );
      if(price!=='all'){
        const [a,b]=price.split('-').map(Number);
        list = list.filter(p=> b? (p.price>=a && p.price<=b) : p.price>=a)
      }
      if(sort==='price-asc') list.sort((a,b)=>a.price-b.price);
      if(sort==='price-desc') list.sort((a,b)=>b.price-a.price);
      renderProducts(list);
    }
    function resetFilters(){document.getElementById('searchInput').value='';document.getElementById('categorySelect').value='all';document.getElementById('priceSelect').value='all';document.getElementById('sortSelect').value='default';renderProducts();}

    /*********************
     * Cart & Wishlist
     *********************/
    function requireLogin(action){const u=currentUser(); if(!u){navigate('login'); alert('Please login first'); return false} return true}

    function getCart(){const u=currentUser(); if(!u) return []; return JSON.parse(localStorage.getItem(cartKey(u.email))||'[]')}
    function saveCart(arr){const u=currentUser(); if(!u) return; localStorage.setItem(cartKey(u.email), JSON.stringify(arr))}

    function addToCart(id){ if(!requireLogin()) return; const u=currentUser(); let cart = getCart(); const prod = products.find(p=>p.id===id); const exist = cart.find(i=>i.id===id); if(exist){exist.qty++;} else cart.push({id:prod.id,title:prod.title,price:prod.price,qty:1,img:prod.img}); saveCart(cart); alert('Added to cart') }

    function renderCart(){ if(!requireLogin()) return; const list = getCart(); const container = document.getElementById('cartList'); container.innerHTML=''; if(list.length===0){container.textContent='Cart is empty'; document.getElementById('cartSummary').textContent=''; return}
      let total=0; list.forEach(item=>{ total += item.price*item.qty; const div = document.createElement('div'); div.className='row'; div.style.marginBottom='8px'; div.innerHTML = `\n        <div style=\"width:80px\"><img src=\"${item.img}\" style=\"width:80px;height:60px;object-fit:cover;border-radius:6px\"></div>\n        <div><strong>${item.title}</strong><div class=\"muted\">$${item.price} x </div></div>\n        <div style=\"margin-left:12px\">Qty: <button class=\"secondary\" onclick=\"changeQty(${item.id},-1)\">-</button> <span style=\"padding:0 8px\">${item.qty}</span> <button onclick=\"changeQty(${item.id},1)\">+</button></div>\n        <div class=\"spacer\"></div>\n        <div><button class=\"secondary\" onclick=\"removeFromCart(${item.id})\">Remove</button></div>\n      `; container.appendChild(div) })
      document.getElementById('cartSummary').textContent = 'Total: $'+total.toFixed(2);
    }

    function changeQty(id,delta){ let cart=getCart(); const it=cart.find(i=>i.id===id); if(!it) return; it.qty += delta; if(it.qty<1) it.qty=1; saveCart(cart); renderCart(); }
    function removeFromCart(id){ let cart=getCart(); cart = cart.filter(i=>i.id!==id); saveCart(cart); renderCart(); }

    // wishlist
    function getWish(){const u=currentUser(); if(!u) return []; return JSON.parse(localStorage.getItem(wishKey(u.email))||'[]')}
    function saveWish(arr){const u=currentUser(); if(!u) return; localStorage.setItem(wishKey(u.email), JSON.stringify(arr))}
    function toggleWish(id){ if(!requireLogin()) return; const prod = products.find(p=>p.id===id); let w=getWish(); if(w.find(i=>i.id===id)){ w = w.filter(i=>i.id!==id); saveWish(w); alert('Removed from wishlist'); } else { w.push({id:prod.id,title:prod.title,price:prod.price,img:prod.img}); saveWish(w); alert('Added to wishlist'); } renderWishlist(); }
    function renderWishlist(){ if(!requireLogin()) return; const w=getWish(); const container=document.getElementById('wishListContainer'); container.innerHTML=''; if(w.length===0){container.textContent='No items in wishlist'; return} w.forEach(item=>{ const div=document.createElement('div'); div.className='row'; div.style.marginBottom='8px'; div.innerHTML=`<div style="width:80px"><img src="${item.img}" style="width:80px;height:60px;object-fit:cover;border-radius:6px"></div><div><strong>${item.title}</strong><div class="muted">$${item.price}</div></div><div class="spacer"></div><div><button onclick="addToCart(${item.id})">Add to cart</button> <button class="secondary" onclick="toggleWish(${item.id})">Remove</button></div>`; container.appendChild(div) }) }

    /*********************
     * Auth: register / login
     *********************/
    function doRegister(){ const name=document.getElementById('regName').value.trim(); const email=document.getElementById('regEmail').value.trim().toLowerCase(); const pass=document.getElementById('regPass').value; if(!name||!email||!pass){document.getElementById('regMsg').textContent='All fields required'; return}
      const users = getUsers(); if(users.find(u=>u.email===email)){document.getElementById('regMsg').textContent='Email already exists'; return}
      users.push({name, email, pass}); saveUsers(users); setCurrentUser({name,email}); document.getElementById('regMsg').textContent='Account created! Logged in.'; renderNav(); navigate('home'); }

    function doLogin(){ const email=document.getElementById('loginEmail').value.trim().toLowerCase(); const pass=document.getElementById('loginPass').value; const users=getUsers(); const u=users.find(x=>x.email===email && x.pass===pass); if(!u){document.getElementById('loginMsg').textContent='Invalid credentials'; return} setCurrentUser({name:u.name,email:u.email}); document.getElementById('loginMsg').textContent='Logged in'; renderNav(); navigate('home'); }

    function doLogout(){ localStorage.removeItem('currentUser'); renderNav(); navigate('home'); }

    /*********************
     * Checkout & Orders
     *********************/
    function checkout(){ if(!requireLogin()) return; let cart=getCart(); if(cart.length===0){alert('Cart empty'); return}
      const u=currentUser(); const orders = JSON.parse(localStorage.getItem(ordersKey(u.email))||'[]'); const order = {id:Date.now(),items:cart.map(i=>({...i})),total:cart.reduce((s,i)=>s+i.price*i.qty,0),date:new Date().toISOString()}; orders.push(order); localStorage.setItem(ordersKey(u.email),JSON.stringify(orders)); saveCart([]); alert('Order placed!'); navigate('profile'); }

    function renderProfile(){ if(!requireLogin()) return; const u=currentUser(); document.getElementById('profileInfo').innerHTML=`<div><strong>${u.name}</strong><div class="muted">${u.email}</div></div>`;
      const orders = JSON.parse(localStorage.getItem(ordersKey(u.email))||'[]'); const list = document.getElementById('ordersList'); list.innerHTML=''; if(orders.length===0){list.innerHTML='<li>No orders yet</li>'; return}
      orders.slice().reverse().forEach(o=>{ const li = document.createElement('li'); li.innerHTML = `<div><strong>Order #${o.id}</strong> — ${new Date(o.date).toLocaleString()} — Total: $${o.total.toFixed(2)}</div><div class=\"muted\">Items: ${o.items.map(it=>it.title+' (x'+it.qty+')').join(', ')}</div>`; list.appendChild(li) }) }

    /*********************
     * Initialization
     *********************/
    function init(){ populateCategory(); renderNav(); renderProducts();
      const h = location.hash.replace('#','') || 'home'; navigate(h);
    }

    // initialize
    init();
  </script>
</body>
</html>
